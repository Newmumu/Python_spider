## 【黑盒测试用例设计】测试方法之等价类划分法

**原理**：把输入或输出数据划分为有效和无效等价类，从每个等价类中选取具有代表性的数据进行测试。

**考虑范围**：输入值、输出值、内部值、时间关系、计算、测试前置或后置条件、配置等。

**适用场景**：只要有输入或输出。

**使用技巧**

- 把尽可能多的有效等价类设计到一条测试用例中；
- 采用边界值分析法进行有效补充；
- 每个无效等价类就是一条测试用例；
- 子集不能相交；
- 子集不能为空；
- 子集的合集应该等同于原始集合。

**划分等价类的六大原则**

1. (1+2)在输入条件规定了取值范围或值的个数的情况下，则可以确立一个有效等价类和两个无效等价类。如：输入值是学生成绩，范围是0~100
2. (1+1)在输入条件规定了输入值的集合或者规定了“必须如何”的条件的情况下，可确立一个有效等价类和一个无效等价类
3. (1+1)在输入条件是一个布尔量的情况下，可确定一个有效等价类和一个无效等价类，布尔量是一个二值枚举类型，一个布尔量具有两种状态：true和false
4. (n+1)在规定了输入数据的一组值（假定n个），并且程序要对每一个输入值分别处理的情况下，可确立n个有效等价类
5. (1+n)在规定了输入数据必须遵守的规则的情况下，可确立一个有效等价类（符合规则）和若干个无效等价类（从不同角度违反规则）

在确知已划分的等价类中各元素在程序处理中的方式不同的情况下，则应再将该等价类进一步的划分为更小的等价类

**生成测试用例**：
1. 为每个等价类规定一个唯一的编号；
1. 设计一个新的测试用例，使其尽可能多地覆盖尚未覆盖的有效等价类。重复这一步，最后使得所有有效等价类均被测试用例所覆盖；
1. 设计一个新的测试用例，使其只覆盖一个无效等价类。重复这一步使得所有无效等价类均被覆盖。   

**应用实例**

等价类划分实例

1、某日期检查程序，要求用户输入以年月表示的日期。假设日期限定在1990年1月~2049年12月，并规定日期由6位数字字符组成，前4位表示年，后2位表示月。现用等价类划分法设计测试用例，来测试程序的"日期检查功能"。（不考虑2月的问题）

（1）阅读程序规格说明书，识别影响程序输出结果的因子。这里包括输入类型和长度（6位数字字符）、输入组成（前4位表示年、后2位表示月）。

（2）针对不同的因子划分出有效等价类和无效等价类。

    A、输入日期类型和长度。有效等价类：6位数字字符，无效等价类：有非数字字符、少于6位数字字符、多于6位数字字符。
    B、年份范围。有效等价类：[1990,2049]，无效等价类：小于1990，大于2049。
    C、月份范围。有效等价类：[01,12]，无效等价类：等于00，大于12

 依次对不同因子的有效等价类和无效等价类进行编号,获得等价类表如下所示：

|输入等价类	 	|  	有效等价类 		|		无效等价类|
|--|--|--|
|日期的类型及长度|   	(1)6位数字字符    | 		(2)有非数字字符<br>(3)少于6位数字字符<br>(4)多于6位数字字符|
|年份范围			 |	(5)在1990~2049之间 	|	(6)小于1990<br>(7)大于2049|
|月份范围				|(8)在01~12之间		|	(9)等于00<br>(10)大于12|

（3）设计测试用例覆盖有效等价类。每个用例尽可能多地覆盖尚未被覆盖的有效等价类。步骤（2）中的等价类表中列出了3个有效等价类，编号分别为(1)(5)(8),设计的测试用例如下：

	TestCase1：输入测试数据200211，输出日期合法。覆盖的有效等价类为：(1)(5)(8)  <-- 强弱一般等价类就只有这1个用例。仅覆盖有效等价类。

（4）设计测试用例覆盖无效等价类，每个用例仅覆盖一个尚未被覆盖的无效等价类。设计结果如下：

	TestCase2：输入测试数据95June,输出日期不合法。覆盖无效等价类：(2)有非数字字符
	TestCase3：输入测试数据20036，输出日期不合法。覆盖无效等价类：(3)少于6位数字字符
	TestCase4：输入测试数据2001006，输出日期不合法。覆盖无效等价类： (4) 多于6位数字字符
	TestCase5：输入测试数据198912，输出日期不合法。覆盖无效等价类：(6) 年份小于1990
	TestCase6：输入测试数据205401，输出日期不合法。覆盖无效等价类：(7)年份大于2049
	TestCase7：输入测试数据201800，输出日期不合法。覆盖无效等价类： (9) 月份等于00
	TestCase8：输入测试数据200113，输出日期不合法。覆盖无效等价类：(10) 月份大于12

这里属于弱健壮等价类测试，仅考虑单缺陷假设，不做多缺陷假设。如果是强健壮等价类测试用例设计，还包括如下：

	TestCase9：输入测试数据2June，输出日期不合法。覆盖无效等价类：(2)(3)覆盖 少于6位并且包含非数字字符
	TestCase10：输入测试数据200June，输出日期不合法。覆盖无效等价类：(2)(4) 覆盖 大于6位并且包含非数字字符
	TestCase11：输入测试数据1989Je，输出日期不合法。覆盖无效等价类：(2)(6)覆盖 年份小于1990并且包含非数字字符
	TestCaseN： ...
