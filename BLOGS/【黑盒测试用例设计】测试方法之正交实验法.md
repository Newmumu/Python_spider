## 【黑盒测试用例设计】测试方法之正交实验法

**原理**：正交试验法是研究多因素、多水平组合的一种试验法，它是利用正交表来对试验进行设计，通过少数的试验替代全面试验，根据正交表的正交性从全面试验中挑选适量的、有代表性的点进行试验，这些有代表性的点具备了“均匀分散，整齐可比”的特点。**定义**：依据Galois理论,从大量的（实验）数据（测试例）中挑选适量的,有代表性的点（例）,从而合理地安排实验（测试）的一种科学实验设计方法.类似的方法有:聚类分析方法,因子方法方法等。

**适用场景**：多因素、多水平组合（3个或3个以上的试验因素）。

**使用技巧**：使用PICT工具。

- 涉及正交实验表理论分析

1. 提取功能说明,构造因子--状态表

把影响实验指标的条件称为**因子**.而影响实验因子的条件叫**因子的状态**.

利用正交实验设计方法来设计测试用例时,首先要根据被测试软件的规格说明书找出影响其功能实现的操作对象和外部因素,把他们当作因子,而把各个因子的取值当作状态.对软件需求规格说明中的功能要求进行划分,把整体的概要性的功能要求进行层层分解与展开,分解成具体的有相对独立性的基本的功能要求.这样就可以把被测试软件中所有的因子都确定下来,并为确定个因子的权值提供参考的依据.**确定因子与状态**是设计测试用例的关键.因此要求尽可能全面的正确的确定取值,以确保测试用例的设计作到完整与有效。

2. 加权筛选,生成因素分析表

对因子与状态的选择可按其重要程度分别加权.可根据各个因子及状态的**作用大小,出现频率的大小以及测试的需要**,确定权值的大小。

3. 利用正交表构造测试数据集

正交表的推导依据Galois理论（这里省略,需要时可查数理统计方面的教材）。

- 设计正交实验表方法

1. 正交实验设计方法

一般用L代表正交表，常用的有L8(2^7)、L9(3^4)、L16(4^5)、L8(4*2^4)、L18(2*3^7)、等。此符号各数字的意义如下。

以L8(2^7)为例，其中7为此表列的数目（最多可安排的因子数）；2为因子的水平数；8为此表行的数目（试验次数）。

又如L18(2\*3^7)，7列是3水平的，有1列是2水平的，用它来安排试验，做18个试验最多可以考察1个2水平因子和7个3水平因子。

试验次数（行数）=∑(每列水平数-1)+1，如L8(2^7)，8=7\*(2-1)+1，利用上述关系式可以从所要考察的因子水平数来决定最低的试验次数，进而选择合适的正交表。比如要考察5个3水平因子及1个2水平因子，则起码的试验次数为5\*(3-1)+1\*(2-1)+1=12（次），可选用既有2水平列又有3水平列的正交表，L18(2\*3^7)。

正交表的两条性质：每一列中各数字出现的次数都一样多；任何两列所构成的各有续数对出现的次数都一样多。所以称之为正交表。

2. 正交实验测试用例设计步骤

利用正交实验设计测试用例的步骤如下

![流程图](https://images2015.cnblogs.com/blog/517473/201705/517473-20170516163148728-1658013620.png)

流程图如下：
```flow
开始=>start: 开始
目的与要求=>operation: 试验目的与要求
选因素=>operation: 选因素、定水平
转换标准结构=>operation: 转换标准结构
选择合适正交表=>operation: 选择合适正交表
正交表详细设计=>operation: 正交表详细设计
工程实验=>condition: 是否是工程实验？
实验结果分析=>subroutine: 实验结果分析//多用于工程实验，需要使用一次实验代替所有实验的情况下
测试方案（删除整合）=>operation: 测试方案（删除整合）
测试用例编写=>operation: 测试用例编写
结束=>end: 结束

开始->目的与要求->选因素->转换标准结构->选择合适正交表->正交表详细设计->工程实验
工程实验(no)->测试方案（删除整合）->测试用例编写->结束
工程实验(yes)->实验结果分析->结束
```

利用正交实验设计方法设计测试用例,比使用等价类划分,边界值分析,因果图等方法有以下优点:
	节省测试工作工时；<br>
	可控制生成的测试用例数量；<br>
	测试用例具有一定的覆盖率。

**应用实例**

![设计实例1](https://images2015.cnblogs.com/blog/517473/201705/517473-20170516163241728-2093088032.jpg)

![设计实例2](https://images2015.cnblogs.com/blog/517473/201705/517473-20170516163254947-1814910845.jpg)

实例：
1. 因素数和水平数刚好符合正交表

如测试一个登陆，需要输入用户名、密码和验证码，则用户名、密码和验证码是因素，每个因素都有填和不填两种水平（状态），则n= k\*(m-1)-1=3\*(2-1)+1=4组测试用例，根据正交实验法设计正交表如下

|状态\因素	|用户名	|密码		|验证码|
|-|-|-|-|
|1			|填		|填			|不填|
|2			|填		|不填		|填|
|3			|不填	|	填		|填|
|4			|不填	|	不填		|不填|

2. 因素的水平数不相符

如一个功能需要一个用户提交性别、学历、政治面貌3个数据，每个数据要求如下：
性别：取值为男、女2种
学历：取值为大专、本科、硕士、博士4种
政治面貌：取值为群众、共青团员、中共党员3种

因素状态表：

|状态\因素 	|性别 	|学历 	|政治面貌|
|-|-|-|-|
|1			|男		|大专	|群众|
|2			|女		|本科	|共青团员|
|3			|		|硕士	|中共党员|
|4			|		|博士	|		|

正交表如下：

|测试用例|性别|学历|政治面貌|
|-|-|-|-|
|1 |男|大专|群众|
|2 |男|本科|共青团员|
|3 |女|硕士|中共党员|
|4 |女|博士|共青团员|
|5 |男|硕士|群众|
|6 |男|博士|中共党员|
|7 |女|本科|中共党员|
|8 |女|大专|共青团员|
|9 |男|本科|群众|
|10|男|大专|中共党员|
|11|女|博士|群众|
|12|女|硕士|共青团员|
