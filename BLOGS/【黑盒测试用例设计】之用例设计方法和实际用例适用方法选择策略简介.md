## 【黑盒测试用例设计】之用例设计方法和实际用例适用方法选择策略简介

### 黑盒测试用例的方法

1. 针对输入或输出条件：**等价类划分法、边界值分析法**；
2. 针对输入或输出条件之间的联系，互相组合：**因果图法、判定表驱动法**；
3. 针对多因素，多水平组合（3个或者3个印上的试验因素）：**正交实验法**；
4. 针对状态迁移和逻辑：**功能图法**；
5. 针对业务流程，事件流：**场景法**；

### 等价类划分法

**原理**：把输入或输出数据划分为有效和无效等价类，从每个等价类中选取具有代表性的数据进行测试。

**考虑范围**：输入值、输出值、内部值、时间关系、计算、测试前置或后置条件、配置等。

**适用场景**：只要有输入或输出。

**使用技巧**

- 把尽可能多的有效等价类设计到一条测试用例中；
- 采用边界值分析法进行有效补充；
- 每个无效等价类就是一条测试用例；
- 子集不能相交；
- 子集不能为空；
- 子集的合集应该等同于原始集合。

### 边界值分析法

**原理**： 针对输入或输出范围的边界值进行测试。

	通常是针对有效等价类的边界值进行测试。

**考虑范围**：变量的最大值、最小值、中间值、比最大值大的值、比最小值小的值。

**适用场景**：有范围的输入或输出。

**使用技巧**：通常结合等价类划分法使用，是作为对等价类划分法的有效补充。

**应用实例**：

-  如果输入条件规定了值的范围,则应取刚达到这个范围的边界的值,以及刚刚超越这个范围边界的值作为测试输入数据。

> 例如，如果程序的规格说明中规定："重量在10公斤至50公斤范围内的邮件，其邮费计算公式为……"。作为测试用例，我们应取10及50，还应取10.01,49.99,9.99及50.01等。

- 如果输入条件规定了值的个数,则用最大个数,最小个数,比最小个数少一,比最大个数多一的数作为测试数据。

> 例如，一个输入文件应包括1~255个记录，则测试用例可取1和255，还应取0及256等。

- 将规则1）和2）应用于输出条件，即设计测试用例使输出值达到边界值及其左右的值。

> 例如，某程序的规格说明要求计算出"每月保险金扣除额为0至1165.25元"，其测试用例可取0.00及1165.24、还可取一0.01及1165．26等。

> 例如，一程序属于情报检索系统，要求每次"最少显示1条、最多显示4条情报摘要"，这时我们应考虑的测试用例包括1和4，还应包括0和5等。

- 如果程序的规格说明给出的输入域或输出域是有序集合,则应选取集合的第一个元素和最后一个元素作为测试用例。

- 如果程序中使用了一个内部数据结构,则应当选择这个内部数据结构的边界上的值作为测试用例。

- 分析规格说明,找出其它可能的边界条件。

### 错误猜测法

**原理**：基于经验和直觉推测程序中所有可能存在的各种错误, 从而有针对性的设计测试用例的方法。

**基本思想**：列举出程序中所有可能有的错误和容易发生错误的特殊情况,根据他们选择测试用例。

**适用场景**：几乎所有场景。

**使用技巧**：没有技巧，直觉和经验堆积。

**应用实例**

- 例如, 输入数据和输出数据为0的情况；输入表格为空格或输入表格只有一行。 

- 例如，测试一个对线性表（比如数组）进行排序的程序，可推测列出以下几项需要特别测试的情况：

> 输入的线性表为空表；
> 表中只含有一个元素；
> 输入表中所有元素已排好序；
> 输入表已按逆序排好；
> 输入表中部分或全部元素相同。

- 例如，测试手机终端的通话功能，可以设计各种通话失败的情况来补充测试用例：

> 无SIM 卡插入时进行呼出（非紧急呼叫）；
> 插入已欠费SIM卡进行呼出；
> 射频器件损坏或无信号区域插入有效SIM卡呼出；
> 网络正常，插入有效SIM卡，呼出无效号码（如1、888、333333、不输入任何号码等）；
> 网络正常，插入有效SIM卡，使用“快速拨号”功能呼出设置无效号码的数字。

### 因果图法
**原理**：根据输入条件的组合、约束关系和输出条件的因果关系，利用图解法分析输入条件的各种组合情况，写出判定表，从而设计测试用例的方法。

	因果图法最终生成的就是判定表，它适合于检查程序输入条件的各种组合情况。

**基本思想**：等价类划分法和边界值分析方法都是着重考虑输入条件，但没有考虑输入条件的各种组合、输入条件之间的相互制约关系。这样虽然各种输入条件可能出错的情况已经测试到了，但多个输入条件组合起来可能出错的情况却被忽视了。

	如果在测试时必须考虑输入条件的各种组合，则可能的组合数目将是天文数字，因此必须考虑采用一种适合于描述多种条件的组合、相应产生多个动作的形式来进行测试用例的设计，这就需要利用因果图（逻辑模型）。

**适用场景**：多种输入条件组合。

**使用技巧**：因果图法和判定表结合使用。

**使用方法**：

采用因果图法设计测试用例的步骤：

1. 分析软件规格说明描述中, 那些是原因(即输入条件或输入条件的等价类),那些是结果(即输出条件), 并给每个原因和结果赋予一个标识符。
2. 分析软件规格说明描述中的语义，找出原因与结果之间, 原因与原因之间对应的关系，根据这些关系,画出因果图。
3. 由于语法或环境限制, 有些原因与原因之间,原因与结果之间的组合情况不可能出现，为表明这些特殊情况, 在因果图上用一些记号表明约束或限制条件。
4. 把因果图转换为判定表。
5. 把判定表的每一列拿出来作为依据,设计测试用例。

### 判定表驱动法

**原理**：针对不同逻辑条件的组合值，分别执行不同的操作。 **定义**：判定表是分析和表达多逻辑条件下执行不同操作的情况的工具。

- 判定表的优点

>  能够将复杂的问题按照各种可能的情况全部列举出来，简明并避免遗漏。因此，利用判定表能够设计出完整的测试用例集合。
在一些数据处理问题当中，某些操作的实施依赖于多个逻辑条件的组合，即：针对不同逻辑条件的组合值，分别执行不同的操作。判定表很适合于处理这类问题。

- 判定表通常由四个部分组成如下图所示。

> 条件桩（Condition Stub）：列出了问题得所有条件。通常认为列出的条件的次序无关紧要。
> 动作桩（Action Stub）：列出了问题规定可能采取的操作。这些操作的排列顺序没有约束。
> 条件项（Condition Entry）：列出针对它左列条件的取值。在所有可能情况下的真假值。
> 动作项（Action Entry）：列出在条件项的各种取值情况下应该采取的动作。

- 规则及规则合并

> 规则：任何一个条件组合的特定取值及其相应要执行的操作称为规则。在判定表中贯穿条件项和动作项的一列就是一条规则。显然,判定表中列出多少组条件取值,也就有多少条规则,既条件项和动作项有多少列。
> 化简：就是规则合并有两条或多条规则具有相同的动作，并且其条件项之间存在着极为相似的关系。

- 判定表的建立步骤：（根据软件规格说明）

> 确定规则的个数.假如有n个条件。每个条件有两个取值（0,1）,故有2n种规则。
> 列出所有的条件桩和动作桩。
> 填入条件项。
> 填入动作项。等到初始判定表。
> 简化.合并相似规则（相同动作）。

**适用场景**：多个逻辑条件组合会产生不同的操作情况。

**使用技巧**：

1. 规格说明以判定表形式给出，或很容易转换成判定表。
1. 条件的排列顺序不会也不影响执行哪些操作。
1. 规则的排列顺序不会也不影响执行哪些操作。
1. 每当某一规则的条件已经满足，并确定要执行的操作后,不必检验别的规则。
1. 如果某一规则得到满足要执行多个操作,这些操作的执行顺序无关紧要。

### 正交实验法

**原理**：正交试验法是研究多因素、多水平组合的一种试验法，它是利用正交表来对试验进行设计，通过少数的试验替代全面试验，根据正交表的正交性从全面试验中挑选适量的、有代表性的点进行试验，这些有代表性的点具备了“均匀分散，整齐可比”的特点。**定义**：依据Galois理论,从大量的（实验）数据（测试例）中挑选适量的,有代表性的点（例）,从而合理地安排实验（测试）的一种科学实验设计方法.类似的方法有:聚类分析方法,因子方法方法等。

**适用场景**：多因素、多水平组合（3个或3个以上的试验因素）。

**使用技巧**：使用PICT工具。

### 功能图法

**原理**：一个程序的功能说明通常由动态说明和静态说明组成。动态说明描述了输入数据的次序或转移的次序。静态说明描述了输入条件与输出条件之间的对应关系。用功能图形象地表示程序的功能说明，并机械地生成功能图的测试用例。**定义**：功能图由状态迁移图和布尔函数组成.状态迁移图用状态和迁移来描述.一个状态指出数据输入的位置（或时间）,而迁移则指明状态的改变.同时要依靠判定表或因果图表示的逻辑功能.例,一个简化的自动出纳机ATM的功能图。

功能图法实际上是一种黑盒和白盒相混合（灰盒）的用例设计方法。

功能图法中要用到逻辑覆盖和路径测试的概念和方法（白盒测试方法）。

**适用场景**：状态迁移（测试路径）与逻辑模型。

**使用技巧**：功能图中的每一条路径即是一条测试用例。


### 场景法

**原理**：核心思想是站在用户的角度上检测软件功能，发现软件的错误。

场景法能够以最少的测试成本，来发现最多的与用户平时使用时息息相关的软件缺陷或错误。

**适用场景**：业务流程清晰（工作流或场景）、参与者与系统交互过程。

**使用技巧**：

1. 理解业务需求，分析业务基本流和备选流上所有会影响数据流走向的的各种因素，从用户操作角度拆分流程中各环节，同时考虑时间、网络等因素。
1. 组合场景中可能发生的事件序列。
1. 将环境因素和事件序列进行组合并进行分析推导，得到不同的场景。


### 黑盒测试方法选择策略

测试用例的设计方法不是单独存在的，在实际情况中，往往是综合使用各种方法才能有效地提高测试效率和测试覆盖率，这需要了解方法的原理，积累经验，以提高测试水平。
1. 各种场景下适用测试方法的综合策略

> 优先使用**等价类划分**，包括输入和输出条件的等价划分，把无限测试变成有限测试，减少工作量和提高测试效率的最有效方法。
> 在**任何情况**下都必须考虑**边界值分析法**。
> 对于业务流程清晰的系统，可以利用**场景法**贯穿整个测试案例过程，在案例中综合使用各种测试方法。
> 如果有输入条件的组合，可选择**因果图法**和**判定表驱动法**。
> 通过**功能图法**针对不同时期条件的有效性设计不同的测试数据。
> 使用**错误猜测技术**增加更多的测试用例。
> 对于**参数配置类**，使用**正交实验法**选择较少的组合方式达到最佳效果。
> 对照程序逻辑，检查已设计出的测试用例的逻辑覆盖程度。 如果没有达到要求的覆盖度量标准，应当再补充足够的测试用例。

2. 测试用例的设计步骤】

> 构造根据设计规格得出的基本功能测试用例；
> 边界值测试用例；
> 状态转换测试用例；
> 错误猜测测试用例；
> 异常测试用例；
> 性能测试用例；
> 压力测试用例。

3. 优化测试用例的方法

> 利用设计测试用例的8种方法不断的对测试用例进行分解与合并；
> 采用遗传算法理论进化测试用例；
> 在测试时利用发散思维构造测试用例。
